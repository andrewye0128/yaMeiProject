import h from"https://cdn.jsdelivr.net/npm/axios@1.3.5/+esm";const l="https://yameiproject.onrender.com";let u="";const m=window.location.origin,n="/yaMeiProject/",w="front/",a="back/",r=[],d=document.querySelector("#signup-form"),f=document.querySelector("#login-form"),v=document.querySelector("#adminLogin-form"),s=document.querySelector("#login-name"),y=document.querySelector("#admin-logout"),t=document.querySelector("#email"),o=document.querySelector("#password"),i=document.querySelector("#checkPassword"),g=document.querySelector("#name"),p=document.querySelector("#phone"),S=async()=>{try{const e=await h.post(`${l}/signup`,{email:t.value,password:o.value,checkPawword:i.value,name:g.value,phone:p.value,role:"user"});console.log("\u8A3B\u518A\u6210\u529F"),console.log(e.data),setTimeout('location.assign("/yaMeiProject/back/login.html")',1500),Swal.fire({position:"top",title:"\u8A3B\u518A\u6210\u529F\uFF01\u5373\u53EF\u767B\u5165",timer:1e3,icon:"success",showConfirmButton:!1})}catch(e){console.log("\u8A3B\u518A\u5931\u6557"),console.error("signUp:",e),e.response.data==="Email already exists"&&Swal.fire({icon:"error",title:"\u8A3B\u518A\u5931\u6557",text:"\u300Eemail\u300F\u5DF2\u91CD\u8907\u8A3B\u518A\uFF0C\u8ACB\u91CD\u65B0\u8F38\u5165"})}},c=async()=>{try{const e=await h.post(`${l}/login`,{email:t.value,password:o.value});console.log("\u767B\u5165\u6210\u529F"),console.log(e.data),u=e.data.accessToken,u&&(localStorage.setItem("authToken",u),r.push(e.data.user),localStorage.setItem("userInfo",JSON.stringify(r))),console.log(r[0].role==="admin"),r[0].role==="user"?setTimeout(()=>{location.assign(`${n}${w}index.html`)},1500):r[0].role==="admin"&&setTimeout(()=>{location.assign(`${n}${a}admin-index.html`)},1500),Swal.fire({position:"top",title:"\u767B\u5165\u6210\u529F\uFF01",timer:1e3,icon:"success",showConfirmButton:!1})}catch(e){console.log("\u767B\u5165\u5931\u6557"),console.log("login:",e),Swal.fire({position:"top",title:"\u767B\u5165\u5931\u6557\uFF01",timer:1e3,icon:"error",showConfirmButton:!1})}},I=()=>{localStorage.removeItem("userInfo"),localStorage.removeItem("authToken"),s.innerHTML=`
        <span class="block absolute w-[82px] h-3 group-hover:bg-accent-100 top-4 z-[-1]"></span>
          <a href="${m}${n}${a}login.html">\u767B\u5165/\u8A3B\u518A</a>
      `},$=()=>{localStorage.removeItem("userInfo"),localStorage.removeItem("authToken"),location.assign(`${n}${a}admin-login.html`)},b=()=>{localStorage.getItem("userInfo")&&(JSON.parse(localStorage.getItem("userInfo"))[0].role==="user"?(s.innerHTML=`
        <span class="block absolute w-[45px] h-3 group-hover:bg-accent-100 top-4 z-[-1]"></span>
          <a href="${m}${n}${a}login.html">\u767B\u51FA</a>
      `,console.log("\u5DF2\u63DB\u6210\u767B\u51FA")):(s.innerHTML=`
        <span class="block absolute w-[90px] h-3 group-hover:bg-accent-100 top-4 z-[-1]"></span>
          <a href="${m}${n}${a}login.html">\u767B\u5165/\u8A3B\u518A</a>
      `,console.log("\u5DF2\u63DB\u6210\u767B\u5165/\u8A3B\u518A")))},L=()=>{d.addEventListener("submit",e=>{if(e.preventDefault(),t.value.trim().length===0||o.value.trim().length===0||i.value.trim().length===0||g.value.trim().length===0||p.value.trim().length===0){console.log("\u6C92\u6709\u5B8C\u6574\u8F38\u5165"),Swal.fire({icon:"error",title:"\u8A3B\u518A\u5931\u6557",text:"\u8F38\u5165\u6846\u52FF\u7A7A\u767D\uFF0C\u8ACB\u8F38\u5165\u5B57\u3002"});return}if(o.value!==i.value){Swal.fire({icon:"error",title:"\u8A3B\u518A\u5931\u6557",text:"\u8F38\u5165\u5169\u7D44\u5BC6\u78BC\u4E0D\u76F8\u7B26\uFF0C\u8ACB\u518D\u91CD\u65B0\u78BA\u8A8D\u3002"});return}console.log("\u6709\u5B8C\u6574\u8F38\u5165"),S()})},k=()=>{f.addEventListener("submit",e=>{if(e.preventDefault(),t.value.trim().length===0||o.value.trim().length===0){console.log("\u6C92\u6709\u5B8C\u6574\u8F38\u5165"),Swal.fire({icon:"error",title:"\u767B\u5165\u5931\u6557",text:"\u8F38\u5165\u6846\u52FF\u7A7A\u767D\uFF0C\u8ACB\u8F38\u5165\u5B57\u3002"});return}c()})},x=()=>{v.addEventListener("submit",e=>{if(e.preventDefault(),t.value.trim().length===0||o.value.trim().length===0){console.log("\u6C92\u6709\u5B8C\u6574\u8F38\u5165"),Swal.fire({icon:"error",title:"\u767B\u5165\u5931\u6557",text:"\u8F38\u5165\u6846\u52FF\u7A7A\u767D\uFF0C\u8ACB\u8F38\u5165\u5B57\u3002"});return}c()})},q={authURL:l,signForm:d,emailInput:t,passwordInput:o,checkPasswordInput:i,nameInput:g,phoneInput:p,signUp:S,signAddEvent:L},E={authURL:l,loginForm:f,emailInput:t,passwordInput:o,login:c,loginEvent:k},P={authURL:l,adminLoginForm:v,emailInput:t,passwordInput:o,login:c,adminLoginEvent:x},D={loginName:s,adminLoginName:y,logOut:I,adminLoginOut:$,toggleLoginName:b};export{q as a,E as b,P as c,D as o};
